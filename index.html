<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>SPAMTEST | VIPER ENGINE v8.0</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <style>
        :root { --neon: #00ff41; --dim-neon: #008f11; --alert: #ff3131; --bg: #050505; }
        body { background: var(--bg); color: var(--neon); font-family: 'Consolas', 'Courier New', monospace; margin: 0; display: flex; height: 100vh; }
        
        .sidebar { width: 400px; background: #0a0a0a; border-right: 1px solid var(--dim-neon); padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .main-view { flex-grow: 1; display: flex; flex-direction: column; padding: 10px; background: #000; }
        
        h2 { font-size: 1.2em; text-transform: uppercase; border-bottom: 1px solid var(--dim-neon); padding-bottom: 10px; margin: 0; letter-spacing: 2px; }
        
        .status-box { padding: 10px; border: 1px solid var(--dim-neon); font-size: 0.8em; background: #001100; }
        .live-tag { color: var(--alert); animation: blink 1s infinite; font-weight: bold; }
        @keyframes blink { 0% {opacity: 1;} 50% {opacity: 0;} 100% {opacity: 1;} }

        input, textarea { width: 100%; background: #000; border: 1px solid #222; color: var(--neon); padding: 10px; box-sizing: border-box; }
        .btn { width: 100%; padding: 15px; cursor: pointer; border: none; font-weight: bold; text-transform: uppercase; transition: 0.3s; }
        .btn-run { background: var(--neon); color: #000; }
        .btn-stop { background: var(--alert); color: #fff; }

        #fullLog { flex-grow: 1; overflow-y: auto; border: 1px solid #111; padding: 10px; font-size: 11px; line-height: 1.4; display: flex; flex-direction: column-reverse; }
        .log-line { margin-bottom: 4px; border-bottom: 1px solid #080808; }
        .log-ts { color: #555; }
        .log-verb { color: #aaa; font-style: italic; }
        .log-crit { color: #fff; background: #440000; }
        .log-tx { color: cyan; font-weight: bold; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>VIPER v8.0</h2>
    <div class="status-box">
        STATUS: <span id="st-status">STANDBY</span><br>
        OWNER: 0xa036...8977<br>
        FACTORY: 0x70c4...270f
    </div>

    <div style="flex-grow: 1;">
        <label style="font-size: 0.7em;">PRIVATE KEY (RAM ONLY)</label>
        <input type="password" id="pKey" placeholder="0x...">
        
        <label style="font-size: 0.7em; margin-top: 15px; display: block;">LAST TARGETS ACQUIRED</label>
        <textarea id="tDisplay" rows="10" readonly></textarea>
        
        <label style="font-size: 0.7em; margin-top: 15px; display: block;">DELAY (SEC)</label>
        <input type="number" id="delay" value="60">
    </div>

    <button id="mainBtn" class="btn btn-run" onclick="toggleEngine()">Inizializza Protocollo</button>
</div>

<div class="main-view">
    <div style="padding-bottom: 5px; font-size: 0.8em; color: #555;">FULL VERBOSE CONSOLE OUTPUT:</div>
    <div id="fullLog"></div>
</div>

<script>
    const CONFIG = {
        factory: "0x70c43bf1e1ae424c2f6cfe8df57ffc931462270f",
        abi: ["function launchBlast(address[] memory targets, uint256 amount) external"],
        rpc: "https://paseo.rpc.amforc.com"
    };

    let engineActive = false;
    let wallet, factory;

    function vLog(msg, type = 'norm') {
        const log = document.getElementById('fullLog');
        const line = document.createElement('div');
        line.className = 'log-line';
        const ts = new Date().toLocaleTimeString() + "." + new Date().getMilliseconds();
        
        let style = "";
        if(type === 'crit') style = 'color:white; background: #005500;';
        if(type === 'err') style = 'color:var(--alert); font-weight:bold;';
        
        line.innerHTML = `<span class="log-ts">[${ts}]</span> <span class="log-verb">[ENGINE]</span> <span style="${style}">${msg}</span>`;
        log.prepend(line);
    }

    async function toggleEngine() {
        const key = document.getElementById('pKey').value;
        const btn = document.getElementById('mainBtn');

        if(!engineActive) {
            if(key.length < 64) return alert("Key non valida");
            
            try {
                vLog("Tentativo di connessione al nodo RPC...");
                const provider = new ethers.JsonRpcProvider(CONFIG.rpc);
                wallet = new ethers.Wallet(key, provider);
                factory = new ethers.Contract(CONFIG.factory, CONFIG.abi, wallet);
                
                engineActive = true;
                btn.innerText = "Spegni Motore";
                btn.className = "btn btn-stop";
                document.getElementById('st-status').innerHTML = "RUNNING <span class='live-tag'>●</span>";
                
                vLog(`Autenticazione riuscita per: ${wallet.address}`, 'crit');
                vLog("Avvio ciclo automatico di scansione e blast.");
                runViperCycle();
            } catch (e) {
                vLog("ERRORE CRITICO: " + e.message, 'err');
            }
        } else {
            engineActive = false;
            btn.innerText = "Inizializza Protocollo";
            btn.className = "btn btn-run";
            document.getElementById('st-status').innerText = "STANDBY";
            vLog("Protocollo interrotto manualmente.");
        }
    }

    async function autoScrape() {
        vLog("Avvio modulo Scraper v4...");
        // Simuliamo l'estrazione di indirizzi attivi dalla RAM della rete
        let targets = [];
        for(let i=0; i<15; i++) {
            const temp = ethers.Wallet.createRandom().address;
            targets.push(temp);
            if(i % 5 === 0) vLog(`Identificato peer attivo: ${temp}`);
        }
        document.getElementById('tDisplay').value = targets.join("\n");
        vLog(`Scansione completata. Acquisiti ${targets.length} nuovi target.`);
        return targets;
    }

    async function runViperCycle() {
        if(!engineActive) return;

        vLog("--- INIZIO NUOVO CICLO ---");
        const targets = await autoScrape();
        const amount = 1000000;

        try {
            vLog("Generazione payload transazione...");
            vLog(`Target Payload: ${targets.length} indirizzi`);
            vLog(`Contratto Factory: ${CONFIG.factory}`);
            
            const tx = await factory.launchBlast(targets, amount, {
                gasLimit: 2500000 // Gas forzato per operazioni di clonazione assembly
            });

            vLog(`TX BROADCASTED: <span class="log-tx">${tx.hash}</span>`);
            vLog("In attesa di mining del blocco...");
            
            const receipt = await tx.wait();
            vLog(`TX CONFERMATA nel blocco: ${receipt.blockNumber}`, 'crit');
            vLog(`Gas utilizzato: ${receipt.gasUsed.toString()}`);
            vLog("Spam distribuito con successo.");

        } catch (e) {
            vLog("FALLIMENTO TRANSAZIONE: " + (e.reason || e.message), 'err');
            vLog("Verificare autorizzazione setFactory o saldo gas.", 'err');
        }

        const wait = document.getElementById('delay').value * 1000;
        vLog(`Modalità sleep attiva. Prossimo blast tra ${wait/1000}s...`);
        setTimeout(runViperCycle, wait);
    }
</script>
</body>
</html>
